var querystring = require('querystring');
var request = require('request');

// var form = {
//     lat: '1234',
//     lon: '1234',
//     no: '1'
// };

// var formData = querystring.stringify(items[0]);

// request({
//     headers: {
//         'Content-Type': 'application/x-www-form-urlencoded'
//     },
//     uri: 'http://128.199.195.185/api/v2/givepos2',
//     body: formData,
//     method: 'POST'
// }, function (err, res, body) {
//     //it works!
//     if (err) {
//         console.log("err");
//     }
//     console.log("Works " + items[0].no);
// });
// for (i = 0; i < 5; i++) {
//     console.log("The number is " + i);
// }

var items = [];
items = [
    { lat: '7.920887', lon: '98.395896', no: '1' },
    { lat: '7.920075', lon: '98.395589', no: '2' },
    { lat: '7.917916', lon: '98.394670', no: '1' },
    { lat: '7.915977', lon: '98.393905', no: '1' },
    { lat: '7.914473', lon: '98.393515', no: '1' },
    { lat: '7.913074', lon: '98.393143', no: '1' },
    { lat: '7.912722', lon: '98.393044', no: '1' },
    { lat: '7.912092', lon: '98.392896', no: '1' },
    { lat: '7.911438', lon: '98.392655', no: '1' },
    { lat: '7.909771', lon: '98.391966', no: '1' },
    { lat: '7.908684', lon: '98.391534', no: '1' },
    { lat: '7.908097', lon: '98.391245', no: '1' },
    { lat: '7.907473', lon: '98.390860', no: '1' },
    { lat: '7.906499', lon: '98.390198', no: '1' },
    { lat: '7.905282', lon: '98.389404', no: '1' },
    { lat: '7.904120', lon: '98.388720', no: '1' },
    { lat: '7.903719', lon: '98.388625', no: '1' },
    { lat: '7.903314', lon: '98.388586', no: '1' },
    { lat: '7.902651', lon: '98.388460', no: '1' },
    { lat: '7.901825', lon: '98.388452', no: '1' },
    { lat: '7.901493', lon: '98.388497', no: '1' },
    { lat: '7.900845', lon: '98.388622', no: '1' },
    { lat: '7.900721', lon: '98.388642', no: '1' },
    { lat: '7.898858', lon: '98.389184', no: '1' },
    { lat: '7.898604', lon: '98.389220', no: '1' },
    { lat: '7.896314', lon: '98.389342', no: '1' },
    { lat: '7.894537', lon: '98.389501', no: '1' },
    { lat: '7.892986', lon: '98.389667', no: '1' },
    { lat: '7.891987', lon: '98.389802', no: '1' },
    { lat: '7.891713', lon: '98.387346', no: '1' },
    { lat: '7.891550', lon: '98.385875', no: '1' },
    { lat: '7.891243', lon: '98.385882', no: '1' },
    { lat: '7.890404', lon: '98.385930', no: '1' },
    { lat: '7.889928', lon: '98.385963', no: '1' },
    { lat: '7.889686', lon: '98.386049', no: '1' },
    { lat: '7.889340', lon: '98.386288', no: '1' },
    { lat: '7.890074', lon: '98.388665', no: '1' },
    { lat: '7.890371', lon: '98.389609', no: '1' },
    { lat: '7.890503', lon: '98.389976', no: '1' },
    { lat: '7.890650', lon: '98.390290', no: '1' },
    { lat: '7.890731', lon: '98.390660', no: '1' },
    { lat: '7.890868', lon: '98.391095', no: '1' },
    { lat: '7.890984', lon: '98.391423', no: '1' },
    { lat: '7.891074', lon: '98.391900', no: '1' },
    { lat: '7.891045', lon: '98.392117', no: '1' },
    { lat: '7.890884', lon: '98.392611', no: '1' },
    { lat: '7.890497', lon: '98.393550', no: '1' },
    { lat: '7.890438', lon: '98.393766', no: '1' },
    { lat: '7.890403', lon: '98.394154', no: '1' },
    { lat: '7.890260', lon: '98.395264', no: '1' },
    { lat: '7.890196', lon: '98.396036', no: '1' },
    { lat: '7.890201', lon: '98.396497', no: '1' },
    { lat: '7.890226', lon: '98.396816', no: '1' },
    { lat: '7.890382', lon: '98.397644', no: '1' },
    { lat: '7.889996', lon: '98.397762', no: '1' },
    { lat: '7.889035', lon: '98.398014', no: '1' },
    { lat: '7.887945', lon: '98.398372', no: '1' },
    { lat: '7.886740', lon: '98.398754', no: '1' },
    { lat: '7.886158', lon: '98.398935', no: '1' },
    { lat: '7.885109', lon: '98.399246', no: '1' },
    { lat: '7.884310', lon: '98.399473', no: '1' },
    { lat: '7.883245', lon: '98.399798', no: '1' },
    { lat: '7.882675', lon: '98.399969', no: '1' },
    { lat: '7.882778', lon: '98.398641', no: '1' },
    { lat: '7.882843', lon: '98.398001', no: '1' },
    { lat: '7.882953', lon: '98.396793', no: '1' },
    { lat: '7.883029', lon: '98.395916', no: '1' },
    { lat: '7.883093', lon: '98.395237', no: '1' },
    { lat: '7.882605', lon: '98.395259', no: '1' },
    { lat: '7.881955', lon: '98.395273', no: '1' },
    { lat: '7.881307', lon: '98.395369', no: '1' },
    { lat: '7.880543', lon: '98.395430', no: '1' },
    { lat: '7.879960', lon: '98.395465', no: '1' },
    { lat: '7.879833', lon: '98.395468', no: '1' },
    { lat: '7.878578', lon: '98.395587', no: '1' },
    { lat: '7.878404', lon: '98.395595', no: '1' },
    { lat: '7.877740', lon: '98.395681', no: '1' },
    { lat: '7.877618', lon: '98.395719', no: '1' },
    { lat: '7.877607', lon: '98.395651', no: '1' },
    { lat: '7.877617', lon: '98.395573', no: '1' },
    { lat: '7.877516', lon: '98.395354', no: '1' },
    { lat: '7.877144', lon: '98.394310', no: '1' },
    { lat: '7.876846', lon: '98.393601', no: '1' },
    { lat: '7.876660', lon: '98.393133', no: '1' },
    { lat: '7.876217', lon: '98.391936', no: '1' },
    { lat: '7.876134', lon: '98.391688', no: '1' },
    { lat: '7.876076', lon: '98.391308', no: '1' },
    { lat: '7.875894', lon: '98.390680', no: '1' },
    { lat: '7.875823', lon: '98.390290', no: '1' },
    { lat: '7.875729', lon: '98.390132', no: '1' },
    { lat: '7.875566', lon: '98.389410', no: '1' },
    { lat: '7.875564', lon: '98.389203', no: '1' },
    { lat: '7.875831', lon: '98.388711', no: '1' },
    { lat: '7.876892', lon: '98.387567', no: '1' },
    { lat: '7.878709', lon: '98.385617', no: '1' },
    { lat: '7.879576', lon: '98.384685', no: '1' },
    { lat: '7.879502', lon: '98.382161', no: '1' },
    { lat: '7.879496', lon: '98.381446', no: '1' },
    { lat: '7.875802', lon: '98.379228', no: '1' },
    { lat: '7.875558', lon: '98.379072', no: '1' },
    { lat: '7.874599', lon: '98.378671', no: '1' },
    { lat: '7.873162', lon: '98.378240', no: '1' },
    { lat: '7.872929', lon: '98.378149', no: '1' },
    { lat: '7.870777', lon: '98.380517', no: '1' },
    { lat: '7.870523', lon: '98.380641', no: '1' },
    { lat: '7.869468', lon: '98.380610', no: '1' },
    { lat: '7.869378', lon: '98.380598', no: '1' },
    { lat: '7.869297', lon: '98.380639', no: '1' },
    { lat: '7.868608', lon: '98.380602', no: '1' },
    { lat: '7.868220', lon: '98.380578', no: '1' },
    { lat: '7.867043', lon: '98.380536', no: '1' },
    { lat: '7.865957', lon: '98.380504', no: '1' },
    { lat: '7.864258', lon: '98.380499', no: '1' },
    { lat: '7.863561', lon: '98.380501', no: '1' },
    { lat: '7.862582', lon: '98.380486', no: '1' },
    { lat: '7.861347', lon: '98.380461', no: '1' },
    { lat: '7.860827', lon: '98.380465', no: '1' },
    { lat: '7.860171', lon: '98.380456', no: '1' },
    { lat: '7.859376', lon: '98.380456', no: '1' },
    { lat: '7.858938', lon: '98.380449', no: '1' },
    { lat: '7.858940', lon: '98.380278', no: '1' },
    { lat: '7.858922', lon: '98.380101', no: '1' },
    { lat: '7.858715', lon: '98.379046', no: '1' },
    { lat: '7.858536', lon: '98.378574', no: '1' },
    { lat: '7.858362', lon: '98.378109', no: '1' },
    { lat: '7.858328', lon: '98.377920', no: '1' },
    { lat: '7.858330', lon: '98.377754', no: '1' },
    { lat: '7.858367', lon: '98.377655', no: '1' },
    { lat: '7.858396', lon: '98.377652', no: '1' },
    { lat: '7.858430', lon: '98.377613', no: '1' },
    { lat: '7.858501', lon: '98.377606', no: '1' },
    { lat: '7.858630', lon: '98.377541', no: '1' },
    { lat: '7.858729', lon: '98.377439', no: '1' },
    { lat: '7.858729', lon: '98.377439', no: '1' },
    { lat: '7.859001', lon: '98.376965', no: '1' },
    { lat: '7.859074', lon: '98.376870', no: '1' },
    { lat: '7.859680', lon: '98.376014', no: '1' },
    { lat: '7.860081', lon: '98.375536', no: '1' },
    { lat: '7.860413', lon: '98.375165', no: '1' },
    { lat: '7.860971', lon: '98.374328', no: '1' },
    { lat: '7.861166', lon: '98.373917', no: '1' },
    { lat: '7.861541', lon: '98.372737', no: '1' },
    { lat: '7.861894', lon: '98.371629', no: '1' },
    { lat: '7.862066', lon: '98.371023', no: '1' },
    { lat: '7.862423', lon: '98.370664', no: '1' },
    { lat: '7.862884', lon: '98.370214', no: '1' },
    { lat: '7.862588', lon: '98.369940', no: '1' },
    { lat: '7.862016', lon: '98.369342', no: '1' },
    { lat: '7.861336', lon: '98.368595', no: '1' },
    { lat: '7.861120', lon: '98.368303', no: '1' },
    { lat: '7.860864', lon: '98.368028', no: '1' },
    { lat: '7.859929', lon: '98.366781', no: '1' },
    { lat: '7.859417', lon: '98.366142', no: '1' },
    { lat: '7.858628', lon: '98.365155', no: '1' },
    { lat: '7.858380', lon: '98.364843', no: '1' },
    { lat: '7.858194', lon: '98.364500', no: '1' },
    { lat: '7.858078', lon: '98.364205', no: '1' },
    { lat: '7.858015', lon: '98.363848', no: '1' },
    { lat: '7.857928', lon: '98.363249', no: '1' },
    { lat: '7.857885', lon: '98.362873', no: '1' }
];

var i = 1;                     //  set your counter to 1

function myLoop() {           //  create a loop function
    setTimeout(function () {    //  call a 3s setTimeout when the loop is called
        console.log(i);          //  your code here

        var formDataz = querystring.stringify(items[i]);
        // var contentLength = formData.length;
        request({
            headers: {
                // 'Content-Length': contentLength,
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            uri: 'http://128.199.195.185/api/v2/givepos2',
            body: formDataz,
            method: 'POST'
        }, function (err, res, body) {
            //it works!
            if (err) {
                console.log("err");
            }
            console.log("Works " + items.indexOf(i));
        });
        i++;                     //  increment the counter
        if (i < 160) {            //  if the counter < 10, call the loop function
            myLoop();             //  ..  again which will trigger another 
        }                        //  ..  setTimeout()
    }, 3000)
}

myLoop();                      //  start the loop

Array.prototype.next = function () {
    if (!((this.current + 1) in this)) return false;
    return this[++this.current];
};
Array.prototype.prev = function () {
    return this[--this.current];
};
Array.prototype.current = 0;

// console.log(items.length);